@page "/pin"
@layout AuthLayout

@inject MauiApp1.Data.JournalDb Db
@inject NavigationManager Nav

<div class="page-center">
    <div class="home-card pin-card">

        <h1 class="home-title">Soft Space</h1>
        <p class="home-tagline">Enter your PIN to continue</p>

        <!-- Illustration placeholder (same height as Home) -->
        <div class="home-illustration"></div>

        <!-- PIN input -->
        <input type="password"
               class="pin-input large"
               maxlength="4"
               placeholder="••••"
               @bind="PinInput" />

        <!-- CTA -->
        <button class="gradient-btn"
                @onclick="VerifyPin">
            Unlock Journal
        </button>

        @if (ShowError)
        {
            <p class="error-text">Incorrect PIN</p>
        }

        <p class="privacy-text">
            Your journal stays private 🔒
        </p>

    </div>
</div>

@code {
    private string PinInput = "";
    private bool ShowError = false;

    private async Task VerifyPin()
    {
        ShowError = false;

        if (await Db.VerifyPinAsync(PinInput))
        {
            Nav.NavigateTo("/dashboard", true);
        }
        else
        {
            ShowError = true;
        }
    }
}
